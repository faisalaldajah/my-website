name: Check Website Text

on:
  schedule:
    - cron: "0 * * * *" # كل ساعة
  workflow_dispatch: # تقدر تشغله يدوي
  push:
    branches: [ main ]

jobs:
  check-text:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: Install dependencies
        run: npm install node-fetch

      - name: Run text check
        run: |
          node -e "
          import fetch from 'node-fetch';
          const url = 'https://username.github.io/project-name/';
          const searchText = 'Yazan Khaled';
          const res = await fetch(url);
          const html = await res.text();
          if (html.includes(searchText)) {
            console.log('✅ النص موجود');
          } else {
            console.error('❌ النص مش موجود');
            process.exit(1);
          }
          "
